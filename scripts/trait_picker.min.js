var traits,rarity=0,currentTraits=[],xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){4==xhr.readyState&&(traits=JSON.parse(xhr.responseText))};xhr.open("GET",(window.location+"").replace(/localhost|vermintideutility\.com/,"api.vermintideutility.com")+"/traits");xhr.send();document.getElementById("shield").addEventListener("click",function(){setTraitPickerOpen(!1)});
Array.prototype.slice.call(document.getElementsByName("rarity")).forEach(function(b,a,c){b.addEventListener("change",function(){switch(b.id){case "rarity_uncommon":rarity=0;clearTraits(1);break;case "rarity_rare":rarity=1;clearTraits(2);break;case "rarity_exotic":rarity=2;clearTraits(3);break;case "rarity_veteran":setTrait(0,traits[3][0][0].name,!0),setTrait(1,traits[3][0][1].name,!0),setTrait(2,traits[3][0][2].name,!0)}})});
Array.prototype.slice.call(document.getElementsByClassName("trait_button")).forEach(function(b,a,c){b.addEventListener("click",function(){showPossibleTraits(a,getPossibleTraits(a))})});function setTrait(b,a,c){document.getElementById("trait"+b).innerHTML=void 0!=a.name&&void 0!=a.description?"<h5>"+a.name+"</h5><p>"+a.description+"</p>":"";currentTraits[b]=a;void 0!=c&&(document.getElementById("trait"+b).style.display=c?"block":"none")}
function clearTraits(b){setTrait(0,{},0<b);setTrait(1,{},1<b);setTrait(2,{},2<b);currentTraits=[]}function setTraitPickerOpen(b){document.getElementById("shield").style.display=document.getElementById("trait_picker").style.display=b?"block":"none"}
function showPossibleTraits(b,a){document.getElementById("trait_picker").innerHTML=Handlebars.templates.traits({traits:a});Array.prototype.slice.call(document.getElementsByClassName("trait")).forEach(function(a,e,d){a.addEventListener("click",function(){setTrait(b,{name:a.dataset.name,description:a.dataset.description})})});setTraitPickerOpen(!0)}
function getPossibleTraits(b){var a=[];traits[rarity].forEach(function(c){for(var e=!0,d=0;d<b;d++)if(c[d].name!=currentTraits[d].name){e=!1;break}e&&!a.some(function(a){return a.name==c[b].name&&a.description==c[b].description})&&a.push(c[b])});a.sort(function(a,b){return a.name>b.name?1:b.name>a.name?-1:0});return a}clearTraits(1);
